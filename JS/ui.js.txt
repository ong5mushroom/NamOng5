// File này chuyên vẽ giao diện (Render HTML)
export const UI = {
    showMsg: (text) => {
        const box = document.getElementById('msg-box');
        box.innerText = text; box.style.display = 'block';
        setTimeout(() => box.style.display = 'none', 3000);
    },

    renderEmployeeOptions: (employees) => {
        const sel = document.getElementById('login-user');
        sel.innerHTML = '<option value="">-- Chọn tên --</option>' + 
            employees.map(e => `<option value="${e.id}">${e.name}</option>`).join('');
        sel.disabled = false;
        document.getElementById('login-pin').disabled = false;
        document.getElementById('login-btn').disabled = false;
        document.getElementById('login-btn').classList.remove('opacity-50');
        document.getElementById('login-loading').style.display = 'none';
    },

    switchTab: (tabId, userRole, userTeam) => {
        // Phân quyền hiển thị Tab
        const isAdmin = ['Giám đốc', 'Quản lý', 'Kế toán'].includes(userRole);
        if (!isAdmin) {
            if (tabId === 'th' && userTeam !== 'Tổ Thu Hoạch') return UI.showMsg("Chức năng của Tổ Thu Hoạch");
            if (tabId === 'sx' && userTeam !== 'Tổ Sản Xuất') return UI.showMsg("Chức năng của Tổ Sản Xuất");
        }

        document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
        document.getElementById('view-' + tabId).classList.remove('hidden');
        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelector(`.nav-btn[data-tab="${tabId}"]`).classList.add('active');
    },

    // Hàm vẽ nội dung cho từng trang (Home, Tasks,...)
    renderHome: (houses, harvestLogs, employees) => {
        const container = document.getElementById('view-home');
        // Logic tính toán cơ bản để hiển thị
        const today = new Date().toISOString().split('T')[0];
        const onlineCount = employees.filter(e => e.lastLogin === today).length;
        
        let html = `
            <div class="grid grid-cols-2 gap-3 mb-4">
                <div class="card border-l-4 border-blue-500 text-center"><p class="label">Online</p><p class="text-2xl font-black text-blue-600">${onlineCount}</p></div>
                <div class="card border-l-4 border-green-500 text-center"><p class="label">Sản lượng hôm nay</p><p class="text-2xl font-black text-green-600" id="home-yield">Loading...</p></div>
            </div>
            <div class="card border border-yellow-100 shadow-sm mb-4">
                <div class="flex justify-between items-center mb-2"><h3 class="font-bold text-yellow-600 uppercase"><i class="fas fa-trophy"></i> Bảng Vàng</h3><button id="btn-export-th" class="text-[10px] bg-blue-50 text-blue-600 px-2 py-1 rounded border">Báo cáo</button></div>
                <div id="leaderboard-list"></div>
            </div>
            <p class="label px-1">Danh sách Nhà Nấm</p>
            <div class="space-y-2">
                ${houses.map(h => `
                    <div class="card flex justify-between items-center">
                        <span class="font-bold text-sm">${h.name}</span>
                        <button class="text-[9px] bg-slate-100 border px-2 py-1 rounded uppercase btn-house-log" data-house="${h.name}">Nhật ký</button>
                    </div>`).join('')}
            </div>
        `;
        container.innerHTML = html;
    },

    // ... (Các hàm render khác cho Tasks, SX, TH, Team sẽ tương tự như code cũ nhưng gọn hơn)
    // Để tiết kiệm không gian, tôi chỉ demo cấu trúc. Bạn có thể copy HTML từ bản cũ sang đây.
};